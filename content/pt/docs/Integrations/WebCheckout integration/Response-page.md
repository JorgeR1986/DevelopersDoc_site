---
title: "Página de resposta"
linkTitle: "Página de resposta"
date: 2021-03-29T12:15:39-05:00
description: >
  The Response page is a mandatory page and lets you show the result of the transaction to the payer. Our system redirects the payer to this page once the transaction has been performed. The data with the payment results is sent to your system via HTTP GET method.</br>This page is invoked for all the transaction states: approved, rejected, in validation, awaiting payment (for cash), etc.

weight: 20
tags: ["subtopic"]
---
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/jquery.validate.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/additional-methods.min.js"></script>
<script src="/js/signature-generator/md5.js"></script>
<script src="/js/signature-generator/sha1.js"></script>
<script src="/js/signature-generator/sha256.js"></script>
<script src="/js/signature-generator/signature-generator.js"></script>

## Observações {#considerations}
* Some hosting providers have settings that do not allow sending URLs as parameter values. Exemplo: `&merchant_url=http%3A%2F%2Fwww.myshop.com`
* For Brazil accounts, there is no redirection to the response page.
* Do not depend on the response page to update your database ou execute processes, users may not return to it. Use the confirmation page.
* If you want to display information related to the transaction, we suggest showing at least the following: status, reference value, currency, and date.
* It is recommended to send the `responseUrl` parameter in the payment form ou set Módulo PayU; it has priority the one sent in the parameter. If PayU does not find any, the payment process ends at the Webcheckout.

{{% alert title="Importante" color="warning"%}}
If you want that PayU always shows the transaction information, do not send any value in the `responseUrl` parameter of the payment form, and leave it blank in Módulo PayU. In this case, the buyer cannot return to your website.
{{% /alert %}}

## Variables
Variables sent to the response page.

<details>
<summary>Variables to be sent to the response page</summary>
<br>
<div class="variables"></div>

| Campo | Tipo | Tamanho | Descrição | Applies to |
|-|-|-|-|:-:|
| merchantId | Numérico | 12 | Merchant’s ID number in PayU’s system, you find this number in the account creation mail. | — |
| transactionState | Numérico | 2 | Indicates the transaction’s status in the system.<br>[See the transaction states in the given column]({{< ref "response-codes-and-variables.html#response-codes-sent-to-the-response-page" >}}). | — |
| risk | Decimal (#.00) | — | Risk associated with the transaction. Values between 0 and 1.<br>The higher value, the greater the risk.<br>Formato `###.00`. | — |
| polResponseCode | Alfanumérico | 64 | Código de resposta.<br>[See the response codes in the given column]({{< ref "response-codes-and-variables.html#response-codes-sent-to-the-response-page" >}}). | — |
| referenceCode | Alfanumérico | 255 | Reference of the sale ou order. It must be unique for each transaction sent to the system. | — |
| reference_pol | Alfanumérico | 255 | Reference ou transaction number generated by PayU. | — |
| signature | Alfanumérico | 255 | Digital signature created for each one of the transactions. | — |
| polPaymentMethod | Alfanumérico | 255 | Internal identifier of the used payment methods. | — |
| polPaymentMethodType | Numérico | 2 | The type of payment method used for payment.<br>[See the codes of the payment methods]({{< ref "response-codes-and-variables.html#codes-of-the-payment-methods" >}}). | — |
| installmentsNumber | Numérico | 2 | Número of installments in which the credit card payment was deferred. | — |
| TX_VALUE | Numérico | 14,2 | Valor total da transação. Ele pode conter dois dígitos decimais. Por exemplo 10000.00 ou 10000 | — |
| TX_TAX | Numérico | 14,2 | Valor do IVA da transação, if no VAT is sent, the system applies 19% automatically.<br>Ele pode conter dois dígitos decimais, for example 19000.00.<br>In case you have no VAT you should fill out 0. | — |
| buyerEmail | Alfanumérico | 255 | Campo that contains the buyer’s e-mail to notify the result of the transaction. It is recommended to validate it when the data is taken on a form. | — |
| processingDate | Date (YYYY-MM-DD HH:mm:ss) | — | The date the transaction was made. | — |
| currency | Alfanumérico | 3 | A respectiva moeda na qual o pagamento é feito. O processo de reconciliação é realizado em pesos na taxa representativa do dia. | — |
| cus | Alfanumérico | 255 | The CUS, unique tracking code, is the payment’s reference within the Bank, it applies only to payments with PSE. | PSE Colombia. |
| pseBank | Alfanumérico | 255 | The name of the bank, applies only to payments with PSE. | PSE Colombia. |
| lng | Alfanumérico | 2 | Language in which to display the payment gateway. | — |
| description | Alfanumérico | 255 | Descrição of sale. | — |
| lapResponseCode | Alfanumérico | 64 | Código de resposta that PayU delivers.<br>[See the responses codes in the given column]({{< ref "response-codes-and-variables.html#response-codes-sent-to-the-response-page" >}}). | — |
| lapPaymentMethod | Alfanumérico | 255 | Payment method used in the payment, for example VISA. | — |
| lapPaymentMethodType | Alfanumérico | 255 | Payment method type used in the payment, for example CREDIT_CARD. | — |
| lapTransactionState | Alfanumérico | 32 | Transaction status.<br>[See the transaction status in the given column]({{< ref "response-codes-and-variables.html#response-codes-sent-to-the-response-page" >}}). | — |
| message | Alfanumérico | 255 | Descrição of the transaction status. | — |
| extra1 | Alfanumérico | 255 | Campo adicional para envio de informações sobre a compra. | — |
| extra2 | Alfanumérico | 255 | Campo adicional para envio de informações sobre a compra. | — |
| extra3 | Alfanumérico | 255 | Campo adicional para envio de informações sobre a compra. | — |
| authorizationCode | Alfanumérico | 12 | Autorização Code of the sale. | — |
| merchant_address | Alfanumérico | 255 | Merchant’s address. | — |
| merchant_name | Alfanumérico | 255 | Merchant’s_name | — |
| merchant_url | Alfanumérico | 255 | Merchant’s website URL. | — |
| orderLanguage | Alfanumérico | 2 | Language of the order (ISO-639-1). | — |
| pseCycle | Numérico | — | Identifier generated by PSE. | PSE Colombia |
| pseReference1 | Alfanumérico | 255 | Reference no. 1 for PSE payments. | PSE Colombia |
| pseReference2 | Alfanumérico | 255 | Reference no. 2 for PSE payments. | PSE Colombia |
| pseReference3 | Alfanumérico | 255 | Reference no. 3 for PSE payments. | PSE Colombia |
| telephone | Alfanumérico | 20 | Merchant’s phone number. | — |
| transactionId | Alfanumérico | 36 | Transaction identifier. | — |
| trazabilityCode | Alfanumérico | 64 | Traceability Code of the sale on the merchant's site. | — |
| TX_ADMINISTRATIVE_FEE | Decimal (#.00) | — | Valor of the administrative fee. | — |
| TX_TAX_ADMINISTRATIVE_FEE | Decimal (#.00) | — | Valor of the tax of the administrative fee. | — |
| TX_TAX_ADMINISTRATIVE_FEE_RETURN_BASE | Decimal (#.00) | — | Base value of the administrative fee for the tax refund. | — |
| action_code_description | Alfanumérico | 255 | VISANET response code description. | VISANET Peru |
| cc_holder | Alfanumérico | 150 | Nome of cardholder. | VISANET Peru |
| cc_number | Alfanumérico | — | Credit card number. | VISANET Peru |
| processing_date_time | Date (YYYY-MM-DD) | — | Date of the sale’s processing. | VISANET Peru |
| request_number | Alfanumérico | 9 | Order Número + transaction identifier | VISANET Peru |

</details>

## Integrate the response page
The following is an example in PHP of how you can integrate the response page:

```PHP
<?php
$ApiKey = "4Vj8eK4rloUd272L48hsrarnUA";
$merchant_id = $_REQUEST['merchantId'];
$referenceCode = $_REQUEST['referenceCode'];
$TX_VALUE = $_REQUEST['TX_VALUE'];
$New_value = number_format($TX_VALUE, 1, '.', '');
$currency = $_REQUEST['currency'];
$transactionState = $_REQUEST['transactionState'];
$firma_cadena = "$ApiKey~$merchant_id~$referenceCode~$New_value~$currency~$transactionState";
$firmacreada = md5($firma_cadena);
$firma = $_REQUEST['signature'];
$reference_pol = $_REQUEST['reference_pol'];
$cus = $_REQUEST['cus'];
$extra1 = $_REQUEST['description'];
$pseBank = $_REQUEST['pseBank'];
$lapPaymentMethod = $_REQUEST['lapPaymentMethod'];
$transactionId = $_REQUEST['transactionId'];

if ($_REQUEST['transactionState'] == 4 ) {
	$estadoTx = "Transaction approved";
}

else if ($_REQUEST['transactionState'] == 6 ) {
	$estadoTx = "Transaction rejected";
}

else if ($_REQUEST['transactionState'] == 104 ) {
	$estadoTx = "Error";
}

else if ($_REQUEST['transactionState'] == 7 ) {
	$estadoTx = "Pending payment";
}

else {
	$estadoTx=$_REQUEST['mensaje'];
}


if (strtoupper($firma) == strtoupper($firmacreada)) {
?>
	<h2>Transaction Summary</h2>
	<table>
	<tr>
	<td>Transaction status</td>
	<td><?php echo $estadoTx; ?></td>
	</tr>
	<tr>
	<tr>
	<td>Transaction ID</td>
	<td><?php echo $transactionId; ?></td>
	</tr>
	<tr>
	<td>Reference sale</td>
	<td><?php echo $reference_pol; ?></td>
	</tr>
	<tr>
	<td>Reference transaction</td>
	<td><?php echo $referenceCode; ?></td>
	</tr>
	<tr>
	<?php
	if($pseBank != null) {
	?>
		<tr>
		<td>cus </td>
		<td><?php echo $cus; ?> </td>
		</tr>
		<tr>
		<td>Bank </td>
		<td><?php echo $pseBank; ?> </td>
		</tr>
	<?php
	}
	?>
	<tr>
	<td>total amount</td>
	<td>$<?php echo number_format($TX_VALUE); ?></td>
	</tr>
	<tr>
	<td>Currency</td>
	<td><?php echo $currency; ?></td>
	</tr>
	<tr>
	<td>Description</td>
	<td><?php echo ($extra1); ?></td>
	</tr>
	<tr>
	<td>Entity:</td>
	<td><?php echo ($lapPaymentMethod); ?></td>
	</tr>
	</table>
<?php
}
else
{
?>
	<h1>Error validating digital signature.</h1>
<?php
}
?>
```
<br>

GET example sent to the response page.

```HTML
http://mytestsite.com/response.php?&merchantId=508029&merchant_name=Test+PayU+Test&merchant_address=Av+123+Calle+12&telephone=7512354&merchant_url=http%3A%2F%2Fpruebaslapv.xtrweb.com&transactionState=6&lapTransactionState=DECLINED&message=Declinada&referenceCode=2015-05-27+13%3A04%3A37&reference_pol=7069375&transactionId=f5e668f1-7ecc-4b83-a4d1-0aaa68260862&description=test_payu_01&trazabilityCode=&cus=&orderLanguage=es&extra1=&extra2=&extra3=&polTransactionState=6&signature=e1b0939bbdc99ea84387bee9b90e4f5c&polResponseCode=5&lapResponseCode=ENTITY_DECLINED&risk=1.00&polPaymentMethod=10&lapPaymentMethod=VISA&polPaymentMethodType=2&lapPaymentMethodType=CREDIT_CARD&installmentsNumber=1&TX_VALUE=100.00&TX_TAX=.00&currency=USD&lng=es&pseCycle=&buyerEmail=test%40payulatam.com&pseBank=&pseReference1=&pseReference2=&pseReference3=&authorizationCode=&TX_ADMINISTRATIVE_FEE=.00&TX_TAX_ADMINISTRATIVE_FEE=.00&TX_TAX_ADMINISTRATIVE_FEE_RETURN_BASE=.00
```

## Signature validation
The signature validation allows you to check the data integrity, you must generate the signature with the information you find in the response page and compare it with the information from the signature parameter.

To validate the signature in the response page, you should consider:

* To get the new value `new_value`, approximate the `TX_VALUE` to a decimal, using the rounding method _Round half to even_:
  - If the first decimal is even and the second is `5`, round it to the lowest value.
  - If the first decimal is odd and the second is `5`, round it to the higher value.
  - Otherwise you must round it to the nearest decimal.
* Get the parameters to generate the signature (`merchantId`, `referenceCode`, `TX_VALUE`, `currency` e `transactionState`) from the response page, do not get them from your database. 
* You must store your ApiKey safely.
* Create the signature as follows:

```HTML
"ApiKey~merchantId~referenceCode~new_value~currency~transactionState"
```
<br>

Examples:

**First decimal is an even number and the second is 5**

```
Your apiKey: 4Vj8eK4rloUd272L48hsrarnUA
Parameters get from the response page:
- merchantId = 508029
- referenceCode = TestPayU04
- TX_VALUE = 150.25
- currency = USD
- transactionState = 6

A assinatura é generated as follows:
MD5(4Vj8eK4rloUd272L48hsrarnUA~508029~TestPayU04~150.2~USD~6) = 00286dc735bd9eaa8ae3a3a4cbb40688

signature = 00286dc735bd9eaa8ae3a3a4cbb40688
```

**First decimal is an odd number and the second is 5**

```
Your apiKey: 4Vj8eK4rloUd272L48hsrarnUA 
Parameters get from the response page: 
- merchantId = 508029
- referenceCode = TestPayU04
- TX_VALUE = 150.35
- currency = USD
- transactionState = 6

A assinatura é generated as follows:
MD5(4Vj8eK4rloUd272L48hsrarnUA~508029~TestPayU04~150.4~USD~6) = 9df2bb60e2838170009040982967923f

signature = 9df2bb60e2838170009040982967923f 
```

**Other cases**
```
Your apiKey: 4Vj8eK4rloUd272L48hsrarnUA 
Parameters get from the response page: 
- merchantId = 508029
- referenceCode = TestPayU04
- TX_VALUE = 150.34
- currency = USD
- transactionState = 6

A assinatura é generated as follows:
MD5(4Vj8eK4rloUd272L48hsrarnUA~508029~TestPayU04~150.3~USD~6) = 779f163be9347a691bcdb25064644795

signature = 779f163be9347a691bcdb25064644795 
```

### Compare a sua assinatura {#compare-your-signature}

<!-- Signatue generator - response page -->
<div id="blue-box">
<span class="grey-text-13">
<div>
<form method="POST" id="signature_form_response_page" >
    <table>
        <span class="blue-text-13"><b>Algorithm: &nbsp;</b></span>
        <select id = "signature_algorithm_response_page" class="calc_selector form_control">
            <option  value="md5">MD5</option>
            <option  value="sha1">SHA1</option>
            <option  value="sha256">SHA256</option>
        </select>
        <br>
        <br>
        <span class="calc_text">&nbsp;(</span>
        <input class="form_control" type="text"  id ="signature_apikey_response_page" name = "signature_apikey_response_page" placeholder="ApiKey" maxlength="26"> ~
        <input class="form_control number" type="text"  id ="signature_merchanId_response_page" name = "signature_merchanId_response_page" placeholder="MerchantId" maxlength="7"> ~
        <input class="form_control" type="text"  id ="signature_referenceCode_response_page" name = "signature_referenceCode_response_page" placeholder="Reference" maxlength="255"> ~
        <input class="form_control  number" type="text" id ="signature_amount_response_page" name = "signature_amount_response_page" placeholder="Amount" maxlength="14"> ~
        <select id = "signature_currency_response_page" class="calc_selector form_control" >
            <option  value="USD">USD</option>
            <option  value="COP">COP</option>
            <option  value="MXN">MXN</option>
            <option  value="ARS">ARS</option>
            <option  value="PEN">PEN</option>
            <option  value="BRL">BRL</option>
            <option  value="CLP">CLP</option>
        </select> ~
        <select id = "signature_transaction_state_response_page" class="calc_selector form_control" >
            <option  value="4">4 (Approved)</option>
            <option  value="6">6 (Rejeitada)</option>
            <option  value="104">104 (Erro)</option>
            <option  value="5">5 (Expirada)</option>
            <option  value="7">7 (Pendente)</option>
        </select>
        <span class="calc_text">)</span>
        <br>
        <br>
        <br>
        <span class="blue-text-13"><b>Result:&nbsp;</b></span><input class="form_control" id ="signature_generated_response_page" name = "signature_generated_response_page" value = ""  readonly />
    </table>
    <br>
    <table width="50%"  border="0" cellspacing="2" cellpadding="2">
        <input type="button" name="signature_generate_response_page" id="signature_generate_response_page" value="Gerar assinatura" >
        <input type="button" name="signature_generate_again_response_page" id="signature_generate_again_response_page" value="Gerar nova assinatura" >
    </table>
</form>
</div>
</span>
</div>
<!-- End of signature generator - response page -->

Esta calculadora permite gerar a assinatura usando qualquer um dos métodos de criptografia disponíveis.